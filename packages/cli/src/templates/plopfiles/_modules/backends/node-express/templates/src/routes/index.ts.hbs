/**
 * @module routes
 * @description API route definitions for {{pascalCase name}} backend.
 */

import type { Express, Request, Response } from "express";

interface RouteBinding {
  method: string;
  url: string;
  summary?: string;
  reply?: unknown;
  statusCode?: number;
}

{{#if routes}}
const routeDefinitions: RouteBinding[] = {{{json routes}}};
{{else}}
const routeDefinitions: RouteBinding[] = [];
{{/if}}
const SERVICE_NAME = "{{name}}";

export function registerRoutes(app: Express): void {
  app.get("/healthz", (_req: Request, res: Response) => {
    res.json({
      status: "ok",
      service: SERVICE_NAME,
      timestamp: new Date().toISOString(),
    });
  });

  for (const definition of routeDefinitions) {
    const method = definition.method.toLowerCase() as "get" | "post" | "put" | "patch" | "delete";
    app[method](definition.url, (_req: Request, res: Response) => {
      res.status(definition.statusCode ?? 200).json({
        route: definition.url,
        status: "stubbed",
        summary: definition.summary,
        example: definition.reply,
      });
    });
  }

  if (routeDefinitions.length === 0) {
    app.get("/", (_req: Request, res: Response) => {
      res.json({
        service: SERVICE_NAME,
        status: "pending_implementation",
        message: "Update src/routes/index.ts to expose application endpoints.",
      });
    });
  }
}

export const routes = routeDefinitions;
